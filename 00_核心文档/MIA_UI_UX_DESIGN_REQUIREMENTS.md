# MIA可视化系统UI/UX设计要求文档

**版本**: v1.0  
**日期**: 2026-01-27  
**白皮书依据**: 第五章 5.4 可视化系统  
**参考**: ui-ux-pro-max-skill设计智能原则

---

## 📋 文档概述

本文档定义MIA可视化系统的UI/UX设计要求，结合金融数据可视化的专业性需求和现代UI设计的最佳实践。

**核心目标**:
- 专业性：符合金融行业标准，数据准确清晰
- 实时性：支持实时数据更新，响应迅速
- 可读性：信息层次分明，视觉焦点突出
- 一致性：统一的设计语言和交互模式

---

## 🎨 设计原则

### 1. 专业性优先 (Professionalism First)
- 使用金融行业标准色彩方案（红涨绿跌）
- 数据精度：价格保留2位小数，百分比保留2位小数
- 专业术语：使用标准金融术语，避免口语化表达
- 数据完整性：显示数据来源、更新时间、置信度

### 2. 实时性保障 (Real-time Guarantee)
- 数据更新延迟 < 1秒（交易时段）
- 加载状态明确：骨架屏 > 加载动画 > 空状态
- 增量更新：只更新变化的数据，避免全量刷新
- 性能优化：虚拟滚动、懒加载、数据分页

### 3. 可读性至上 (Readability First)
- 信息层次：标题 > 关键指标 > 详细数据 > 辅助信息
- 视觉焦点：使用颜色、大小、位置引导用户注意力
- 数据密度：避免信息过载，合理留白
- 响应式设计：适配不同屏幕尺寸（1920x1080 / 2560x1440 / 3840x2160）

### 4. 一致性原则 (Consistency Principle)
- 统一的色彩系统
- 统一的字体层级
- 统一的组件样式
- 统一的交互模式

---

## 🎨 色彩系统

### 主题色（红涨绿跌 - 中国A股标准）

**上涨色（红色系）**:
```
- 主红色: #FF4D4F (涨停、强势上涨)
- 次红色: #FF7875 (普通上涨)
- 浅红色: #FFA39E (微涨、背景)
- 极浅红: #FFCCC7 (区间背景)
```

**下跌色（绿色系）**:
```
- 主绿色: #52C41A (跌停、强势下跌)
- 次绿色: #73D13D (普通下跌)
- 浅绿色: #95DE64 (微跌、背景)
- 极浅绿: #B7EB8F (区间背景)
```

**中性色（灰色系）**:
```
- 深灰: #262626 (主要文字)
- 中灰: #595959 (次要文字)
- 浅灰: #8C8C8C (辅助文字)
- 极浅灰: #D9D9D9 (边框、分割线)
- 背景灰: #F5F5F5 (页面背景)
```

**功能色**:
```
- 主题蓝: #1890FF (链接、按钮)
- 警告橙: #FA8C16 (警告、主力成本线)
- 危险红: #F5222D (错误、风险)
- 成功绿: #52C41A (成功、确认)
```

### 色彩使用规则

**K线图色彩**:
- 红色K线：收盘价 > 开盘价（上涨）
- 绿色K线：收盘价 < 开盘价（下跌）
- 白色K线：收盘价 = 开盘价（平盘）

**成交量色彩**:
- 红色柱：上涨日成交量
- 绿色柱：下跌日成交量

**买卖点标注**:
- 买入信号：绿色向上箭头 ↑ (#52C41A)
- 卖出信号：红色向下箭头 ↓ (#FF4D4F)

**板块资金流向**:
- 流入：红色渐变（浅红 → 深红）
- 流出：绿色渐变（浅绿 → 深绿）
- 中性：灰色 (#D9D9D9)

---

## 📝 排版系统

### 字体选择

**中文字体**:
```
主字体: PingFang SC (苹方)
备选: Microsoft YaHei (微软雅黑)
等宽字体: Consolas, Monaco (用于数字)
```

**英文字体**:
```
主字体: -apple-system, BlinkMacSystemFont, 'Segoe UI'
备选: 'Helvetica Neue', Arial
等宽字体: 'SF Mono', Consolas, Monaco
```

### 字号层级

```
特大标题: 32px / 2rem (页面主标题)
大标题: 24px / 1.5rem (模块标题)
中标题: 18px / 1.125rem (卡片标题)
小标题: 16px / 1rem (子标题)
正文: 14px / 0.875rem (主要内容)
辅助文字: 12px / 0.75rem (说明文字)
```

### 行高与间距

```
标题行高: 1.2 (紧凑)
正文行高: 1.5 (舒适)
辅助文字行高: 1.4 (适中)

段落间距: 16px
模块间距: 24px
卡片间距: 16px
```

---

## 📐 布局规范

### 页面布局

**标准布局结构**:
```
┌─────────────────────────────────────────────────────────────┐
│  顶部导航栏 (64px)                                           │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌───────────────────────────────────────┐ │
│  │             │  │                                       │ │
│  │  侧边栏     │  │  主内容区                              │ │
│  │  (240px)    │  │  (自适应宽度)                          │ │
│  │             │  │                                       │ │
│  └─────────────┘  └───────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

**响应式断点**:
```
超大屏: ≥ 1920px (主力屏幕)
大屏: 1440px - 1919px
中屏: 1024px - 1439px
小屏: < 1024px (不推荐，仅基础功能)
```

### 卡片布局

**标准卡片**:
```
- 圆角: 8px
- 阴影: 0 2px 8px rgba(0, 0, 0, 0.08)
- 内边距: 24px
- 边框: 1px solid #F0F0F0
- 背景: #FFFFFF
```

**卡片间距**:
```
- 卡片之间: 16px
- 卡片内元素: 12px
- 标题与内容: 16px
```

### 网格系统

**12列网格**:
```
- 列宽: 自适应
- 间距: 16px
- 外边距: 24px
```

**常用布局**:
```
- 全宽: 12列
- 半宽: 6列
- 三分之一: 4列
- 四分之一: 3列
```

---

## 📊 K线图设计规范

### K线图布局

**标准K线图结构**:
```
┌─────────────────────────────────────────────────────────────┐
│  工具栏: [日K] [周K] [月K] [5分] [15分] [60分]              │
├─────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────┐  │
│  │  K线主图区域 (高度: 400px)                            │  │
│  │  - K线（红涨绿跌）                                    │  │
│  │  - 均线系统（MA5/MA10/MA20/MA60）                     │  │
│  │  - 主力成本线（橙色虚线）                             │  │
│  │  - 买卖点标注（B/S标记）                              │  │
│  └───────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────┐  │
│  │  成交量区域 (高度: 120px)                             │  │
│  │  - 成交量柱状图（红涨绿跌）                           │  │
│  │  - 主力资金流向（叠加显示）                           │  │
│  └───────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────┐  │
│  │  技术指标区域 (高度: 120px，可选)                     │  │
│  │  [MACD] [KDJ] [RSI] [BOLL] [主力资金]                 │  │
│  └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### K线样式

**红色K线（上涨）**:
```css
{
  fill: #FF4D4F,           /* 实心填充 */
  stroke: #FF4D4F,         /* 边框颜色 */
  stroke-width: 1px,       /* 边框宽度 */
  opacity: 1.0             /* 不透明 */
}
```

**绿色K线（下跌）**:
```css
{
  fill: #52C41A,           /* 实心填充 */
  stroke: #52C41A,         /* 边框颜色 */
  stroke-width: 1px,       /* 边框宽度 */
  opacity: 1.0             /* 不透明 */
}
```

**白色K线（平盘）**:
```css
{
  fill: none,              /* 空心 */
  stroke: #8C8C8C,         /* 灰色边框 */
  stroke-width: 1px,
  opacity: 1.0
}
```

### 均线样式

```css
MA5:  { color: #FFFFFF, width: 1.5px, style: solid }  /* 白色 */
MA10: { color: #FAAD14, width: 1.5px, style: solid }  /* 黄色 */
MA20: { color: #722ED1, width: 1.5px, style: solid }  /* 紫色 */
MA60: { color: #1890FF, width: 1.5px, style: solid }  /* 蓝色 */
```

### 主力成本线样式

```css
{
  color: #FA8C16,          /* 橙色 */
  width: 2px,
  style: dashed,           /* 虚线 */
  dash-array: [5, 5],      /* 虚线间隔 */
  opacity: 0.8
}

/* 成本区间阴影 */
{
  fill: #FA8C16,
  opacity: 0.1             /* 10%透明度 */
}
```

### 买卖点标注样式

**买入信号（B标记）**:
```css
{
  symbol: '↑',             /* 向上箭头 */
  color: #52C41A,          /* 绿色 */
  size: 16px,
  position: 'below',       /* K线下方 */
  offset: -10px
}
```

**卖出信号（S标记）**:
```css
{
  symbol: '↓',             /* 向下箭头 */
  color: #FF4D4F,          /* 红色 */
  size: 16px,
  position: 'above',       /* K线上方 */
  offset: 10px
}
```

### 成交量样式

```css
/* 上涨日成交量 */
{
  fill: #FF4D4F,           /* 红色 */
  opacity: 0.6
}

/* 下跌日成交量 */
{
  fill: #52C41A,           /* 绿色 */
  opacity: 0.6
}
```

### 交互效果

**鼠标悬停**:
```
- 显示十字光标
- 显示当日详细数据卡片:
  * 日期: 2026-01-27
  * 开盘: 10.50
  * 收盘: 10.80
  * 最高: 10.95
  * 最低: 10.45
  * 成交量: 1.2亿
  * 涨跌幅: +2.86%
```

**点击买卖点标记**:
```
- 显示信号详情弹窗:
  * 信号类型: 买入/卖出
  * 信号价格: 10.50
  * 信号来源: 技术面突破
  * 置信度: 85%
  * 建议操作: 建议买入，目标价12.00
```

**缩放与拖动**:
```
- 鼠标滚轮: 缩放时间范围
- 鼠标拖动: 左右移动查看历史
- 双击: 重置缩放
```

---

## 🗺️ 板块资金流向热力图设计规范

### 热力图布局

**标准热力图结构**:
```
┌─────────────────────────────────────────────────────────────┐
│  板块资金流向热力图                                          │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐          │
│  │人工智能 │ │半导体   │ │新能源车 │ │医药生物 │          │
│  │+125.3亿 │ │+98.7亿  │ │+87.2亿  │ │+65.4亿  │          │
│  │+3.8%    │ │+2.9%    │ │+2.1%    │ │+1.8%    │          │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘          │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐          │
│  │军工     │ │消费电子 │ │5G通信   │ │光伏     │          │
│  │+45.2亿  │ │+32.1亿  │ │+28.9亿  │ │+21.5亿  │          │
│  │+1.5%    │ │+1.2%    │ │+0.9%    │ │+0.7%    │          │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘          │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐          │
│  │房地产   │ │银行     │ │保险     │ │煤炭     │          │
│  │-56.8亿  │ │-42.3亿  │ │-35.1亿  │ │-28.6亿  │          │
│  │-1.8%    │ │-0.9%    │ │-0.7%    │ │-0.5%    │          │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘          │
└─────────────────────────────────────────────────────────────┘
```

### 色彩映射规则

**流入强度（红色渐变）**:
```
极强流入 (>100亿): #FF4D4F (深红)
强流入 (50-100亿): #FF7875 (中红)
中等流入 (20-50亿): #FFA39E (浅红)
弱流入 (0-20亿): #FFCCC7 (极浅红)
```

**流出强度（绿色渐变）**:
```
极强流出 (<-50亿): #52C41A (深绿)
强流出 (-50至-20亿): #73D13D (中绿)
中等流出 (-20至-5亿): #95DE64 (浅绿)
弱流出 (-5至0亿): #B7EB8F (极浅绿)
```

**中性（灰色）**:
```
中性 (-5至5亿): #D9D9D9 (灰色)
```

### 板块卡片样式

```css
{
  width: 180px,
  height: 120px,
  border-radius: 8px,
  padding: 16px,
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08),
  cursor: pointer,
  transition: all 0.3s ease
}

/* 悬停效果 */
:hover {
  transform: translateY(-4px),
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12)
}
```

### 板块卡片内容

```
┌─────────────────┐
│ 板块名称 (16px) │  ← 标题，加粗
│                 │
│ +125.3亿 (20px) │  ← 净流入金额，大号字体
│ +3.8% (14px)    │  ← 涨跌幅，正常字体
│                 │
│ 🔥 热度: ★★★★☆  │  ← 热度指标（可选）
└─────────────────┘
```

### 交互效果

**点击板块卡片**:
```
- 展开显示板块详情:
  * 板块内股票列表（TOP10）
  * 资金流向明细
  * 领涨/领跌股
  * 历史资金流向趋势图
```

**悬停效果**:
```
- 卡片上浮4px
- 阴影加深
- 显示简要信息提示
```

---

## 📱 仪表盘设计规范

### 策略分析中心仪表盘

**顶部指标卡片**:
```
┌─────────────────────────────────────────────────────────────┐
│  综合评分: 85/100  │  过拟合风险: 低  │  市场适配: 高    │
└─────────────────────────────────────────────────────────────┘
```

**指标卡片样式**:
```css
{
  display: inline-block,
  width: 33.33%,
  padding: 16px,
  text-align: center,
  border-right: 1px solid #F0F0F0
}

/* 指标值 */
.metric-value {
  font-size: 32px,
  font-weight: bold,
  color: #262626
}

/* 指标标签 */
.metric-label {
  font-size: 14px,
  color: #8C8C8C,
  margin-top: 8px
}
```

### 个股分析仪表盘

**结论性建议卡片**:
```
┌───────────────────────────────────────────────────────────┐
│  🎯 结论性建议                                             │
│  操作建议: 【买入】                    置信度: 85%         │
│  当前价: ¥10.50    建议买入价: ¥10.30-10.50               │
│  目标价: ¥12.00    止损价: ¥9.80                          │
│  仓位建议: 标准仓位（5-8%）   持有周期: 中期（30-60天）    │
│  ✅ 支持原因: 1) 主力持续建仓 2) 技术面突破 3) 板块轮动    │
│  ⚠️ 风险提示: 1) 短期涨幅较大 2) 大盘转弱需止损           │
└───────────────────────────────────────────────────────────┘
```

**建议卡片样式**:
```css
{
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%),
  color: #FFFFFF,
  padding: 24px,
  border-radius: 12px,
  box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3)
}

/* 操作建议 */
.action-recommendation {
  font-size: 24px,
  font-weight: bold,
  color: #52C41A  /* 买入=绿色，卖出=红色 */
}

/* 置信度 */
.confidence {
  font-size: 18px,
  opacity: 0.9
}
```

---

## 🎭 交互设计

### 加载状态

**骨架屏（推荐）**:
```
- 使用灰色占位块模拟内容结构
- 添加闪烁动画（shimmer effect）
- 保持布局稳定，避免内容跳动
```

**加载动画（备选）**:
```
- 使用旋转圆圈或进度条
- 显示加载提示文字
- 超过3秒显示预计剩余时间
```

### 空状态

**无数据状态**:
```
┌─────────────────────────────────────┐
│                                     │
│         📊                          │
│                                     │
│      暂无数据                        │
│                                     │
│  [刷新数据]  [查看历史]              │
│                                     │
└─────────────────────────────────────┘
```

### 错误状态

**错误提示**:
```
┌─────────────────────────────────────┐
│                                     │
│         ⚠️                          │
│                                     │
│      数据加载失败                    │
│      请检查网络连接或稍后重试         │
│                                     │
│  [重试]  [返回]                     │
│                                     │
└─────────────────────────────────────┘
```

### 反馈机制

**成功反馈**:
```
- Toast提示（右上角）
- 绿色背景 + 成功图标
- 自动消失（3秒）
```

**错误反馈**:
```
- Toast提示（右上角）
- 红色背景 + 错误图标
- 手动关闭或5秒后消失
```

**警告反馈**:
```
- Toast提示（右上角）
- 橙色背景 + 警告图标
- 手动关闭或4秒后消失
```

---

## 🚀 性能优化

### 渲染优化

**虚拟滚动**:
```
- 长列表使用虚拟滚动
- 只渲染可见区域的元素
- 滚动时动态加载/卸载
```

**懒加载**:
```
- 图表按需加载
- 图片懒加载
- 组件懒加载
```

**数据分页**:
```
- 每页显示50-100条数据
- 支持无限滚动或分页器
- 预加载下一页数据
```

### 动画性能

**使用CSS动画**:
```css
/* 优先使用transform和opacity */
.smooth-animation {
  transition: transform 0.3s ease, opacity 0.3s ease;
}

/* 避免使用width、height、left、top */
```

**使用requestAnimationFrame**:
```javascript
// 复杂动画使用RAF
function animate() {
  // 动画逻辑
  requestAnimationFrame(animate);
}
```

---

## 📱 响应式设计

### 断点策略

```
超大屏 (≥1920px):
- 显示完整功能
- 3-4列布局
- 大号图表

大屏 (1440-1919px):
- 显示完整功能
- 2-3列布局
- 标准图表

中屏 (1024-1439px):
- 显示核心功能
- 2列布局
- 紧凑图表

小屏 (<1024px):
- 显示基础功能
- 1列布局
- 简化图表
```

### 适配规则

**字体缩放**:
```
超大屏: 基准字号 16px
大屏: 基准字号 14px
中屏: 基准字号 13px
小屏: 基准字号 12px
```

**间距缩放**:
```
超大屏: 标准间距
大屏: 标准间距 × 0.9
中屏: 标准间距 × 0.8
小屏: 标准间距 × 0.7
```

---

## 🎯 可访问性

### 色盲友好

**色彩对比度**:
```
- 文字与背景对比度 ≥ 4.5:1
- 大号文字对比度 ≥ 3:1
- 使用形状和图标辅助颜色
```

**色盲模式**:
```
- 提供色盲模式切换
- 使用纹理和图案辅助
- 避免仅依赖颜色传达信息
```

### 键盘导航

**Tab键顺序**:
```
- 逻辑顺序：从上到下，从左到右
- 跳过隐藏元素
- 焦点可见（outline）
```

**快捷键**:
```
- Ctrl+R: 刷新数据
- Ctrl+P: 打印/导出PDF
- Esc: 关闭弹窗
- ←→: 切换图表周期
```

### 屏幕阅读器

**语义化HTML**:
```html
<header>顶部导航</header>
<nav>侧边栏导航</nav>
<main>主内容区</main>
<article>卡片内容</article>
<aside>辅助信息</aside>
```

**ARIA标签**:
```html
<button aria-label="刷新数据">🔄</button>
<div role="alert">数据加载失败</div>
<img alt="K线图" src="chart.png">
```

---

## 🛠️ 技术实现指南

### 推荐技术栈

**图表库**:
```
主力: ECharts 5.x
- 支持红涨绿跌配置
- 性能优秀（Canvas渲染）
- 中文文档完善
- 丰富的图表类型

备选: TradingView Lightweight Charts
- 专业金融图表
- 性能极佳
- 轻量级（<100KB）
```

**UI框架**:
```
主框架: Streamlit
- 白皮书定义（Port 8501）
- Python原生支持
- 快速开发

组件库: Ant Design (可选)
- 企业级UI组件
- 完整的设计规范
- React生态
```

**实时通信**:
```
WebSocket
- 白皮书定义（Port 8502）
- 实时数据推送
- 低延迟
```

### ECharts配置示例

**K线图配置（红涨绿跌）**:
```javascript
option = {
  xAxis: {
    type: 'category',
    data: dates,
    boundaryGap: false
  },
  yAxis: {
    type: 'value',
    scale: true
  },
  series: [
    {
      name: 'K线',
      type: 'candlestick',
      data: klineData,
      itemStyle: {
        color: '#FF4D4F',      // 上涨K线颜色（红色）
        color0: '#52C41A',     // 下跌K线颜色（绿色）
        borderColor: '#FF4D4F',
        borderColor0: '#52C41A'
      }
    },
    {
      name: 'MA5',
      type: 'line',
      data: ma5Data,
      smooth: true,
      lineStyle: {
        color: '#FFFFFF',
        width: 1.5
      }
    },
    {
      name: 'MA10',
      type: 'line',
      data: ma10Data,
      smooth: true,
      lineStyle: {
        color: '#FAAD14',
        width: 1.5
      }
    },
    {
      name: '主力成本线',
      type: 'line',
      data: costLineData,
      lineStyle: {
        color: '#FA8C16',
        width: 2,
        type: 'dashed'
      },
      markArea: {
        itemStyle: {
          color: 'rgba(250, 140, 22, 0.1)'
        },
        data: [[
          { yAxis: costLower },
          { yAxis: costUpper }
        ]]
      }
    }
  ],
  tooltip: {
    trigger: 'axis',
    axisPointer: {
      type: 'cross'
    },
    formatter: function(params) {
      // 自定义悬停提示
      return `
        日期: ${params[0].name}
        开盘: ${params[0].data[1]}
        收盘: ${params[0].data[2]}
        最高: ${params[0].data[4]}
        最低: ${params[0].data[3]}
        涨跌幅: ${params[0].data[5]}%
      `;
    }
  },
  dataZoom: [
    {
      type: 'inside',
      start: 50,
      end: 100
    },
    {
      show: true,
      type: 'slider',
      bottom: 10,
      start: 50,
      end: 100
    }
  ]
};
```

**板块资金流向热力图配置**:
```javascript
option = {
  tooltip: {
    position: 'top'
  },
  grid: {
    height: '50%',
    top: '10%'
  },
  xAxis: {
    type: 'category',
    data: sectorNames,
    splitArea: {
      show: true
    }
  },
  yAxis: {
    type: 'category',
    data: ['资金流向'],
    splitArea: {
      show: true
    }
  },
  visualMap: {
    min: -100,
    max: 100,
    calculable: true,
    orient: 'horizontal',
    left: 'center',
    bottom: '15%',
    inRange: {
      color: ['#52C41A', '#B7EB8F', '#D9D9D9', '#FFCCC7', '#FF4D4F']
      // 绿色（流出） → 灰色（中性） → 红色（流入）
    }
  },
  series: [
    {
      name: '资金流向',
      type: 'heatmap',
      data: heatmapData,
      label: {
        show: true,
        formatter: function(params) {
          return params.value[2] > 0 
            ? `+${params.value[2]}亿` 
            : `${params.value[2]}亿`;
        }
      },
      emphasis: {
        itemStyle: {
          shadowBlur: 10,
          shadowColor: 'rgba(0, 0, 0, 0.5)'
        }
      }
    }
  ]
};
```

### Streamlit集成示例

**基础页面结构**:
```python
import streamlit as st
import streamlit.components.v1 as components

# 页面配置
st.set_page_config(
    page_title="MIA可视化系统",
    page_icon="📊",
    layout="wide",
    initial_sidebar_state="expanded"
)

# 自定义CSS
st.markdown("""
<style>
    .main {
        background-color: #F5F5F5;
    }
    .stButton>button {
        background-color: #1890FF;
        color: white;
        border-radius: 4px;
    }
</style>
""", unsafe_allow_html=True)

# 顶部标题
st.title("📊 MIA可视化系统")

# 侧边栏
with st.sidebar:
    st.header("导航")
    page = st.radio(
        "选择页面",
        ["策略分析中心", "个股分析", "板块资金监控"]
    )

# 主内容区
if page == "策略分析中心":
    render_strategy_dashboard()
elif page == "个股分析":
    render_stock_dashboard()
elif page == "板块资金监控":
    render_sector_dashboard()
```

**ECharts集成**:
```python
def render_kline_chart(symbol: str):
    """渲染K线图"""
    # 获取数据
    kline_data = get_kline_data(symbol)
    
    # 生成ECharts配置
    option = generate_kline_option(kline_data)
    
    # 渲染图表
    components.html(f"""
    <div id="kline-chart" style="width: 100%; height: 600px;"></div>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <script>
        var chart = echarts.init(document.getElementById('kline-chart'));
        var option = {option};
        chart.setOption(option);
        
        // 响应式
        window.addEventListener('resize', function() {{
            chart.resize();
        }});
    </script>
    """, height=600)
```

**实时数据更新**:
```python
import asyncio
import websockets

async def stream_market_data():
    """实时数据流"""
    uri = "ws://localhost:8502/market_data"
    
    async with websockets.connect(uri) as websocket:
        while True:
            data = await websocket.recv()
            # 更新UI
            st.session_state.market_data = json.loads(data)
            st.experimental_rerun()

# 启动实时数据流
if st.button("开始实时监控"):
    asyncio.run(stream_market_data())
```

---

## 🎨 设计反模式（避免）

### 反模式1: 信息过载
```
❌ 错误: 在一个页面塞入所有图表和数据
✅ 正确: 分层展示，核心指标优先，详细数据折叠
```

### 反模式2: 颜色混乱
```
❌ 错误: 使用多种颜色方案，红绿混用
✅ 正确: 统一使用红涨绿跌，保持一致性
```

### 反模式3: 交互不明确
```
❌ 错误: 可点击元素没有视觉反馈
✅ 正确: 悬停变色，点击有反馈，加载有提示
```

### 反模式4: 性能忽视
```
❌ 错误: 一次性渲染1000根K线
✅ 正确: 默认显示200根，支持缩放和分页
```

### 反模式5: 移动端忽视
```
❌ 错误: 只考虑桌面端，移动端无法使用
✅ 正确: 响应式设计，移动端简化但可用
```

---

## 📋 设计检查清单

### 视觉设计
- [ ] 使用统一的色彩系统（红涨绿跌）
- [ ] 字体层级清晰（6级）
- [ ] 间距统一（8px基准）
- [ ] 圆角统一（8px）
- [ ] 阴影统一（0 2px 8px rgba(0,0,0,0.08)）

### 交互设计
- [ ] 所有可点击元素有悬停效果
- [ ] 加载状态明确（骨架屏/加载动画）
- [ ] 错误提示友好（Toast/弹窗）
- [ ] 操作有反馈（成功/失败/警告）
- [ ] 支持键盘导航

### 性能优化
- [ ] 图表懒加载
- [ ] 长列表虚拟滚动
- [ ] 数据分页
- [ ] 图片懒加载
- [ ] 动画使用transform和opacity

### 响应式设计
- [ ] 支持1920px及以上
- [ ] 支持1440-1919px
- [ ] 支持1024-1439px
- [ ] 移动端基础功能可用

### 可访问性
- [ ] 色彩对比度 ≥ 4.5:1
- [ ] 支持键盘导航
- [ ] 语义化HTML
- [ ] ARIA标签完整
- [ ] 屏幕阅读器友好

---

## 🎯 设计目标验收标准

### 专业性
- ✅ 使用金融行业标准色彩（红涨绿跌）
- ✅ 数据精度符合要求（价格2位小数）
- ✅ 专业术语准确
- ✅ 数据来源和更新时间明确

### 实时性
- ✅ 数据更新延迟 < 1秒
- ✅ 页面加载时间 < 2秒
- ✅ 交互响应时间 < 100ms
- ✅ 图表渲染时间 < 1秒

### 可读性
- ✅ 信息层次分明
- ✅ 视觉焦点突出
- ✅ 数据密度合理
- ✅ 留白充足

### 一致性
- ✅ 色彩系统统一
- ✅ 字体层级统一
- ✅ 组件样式统一
- ✅ 交互模式统一

---

## 📚 参考资源

### 设计规范
- [Ant Design 设计规范](https://ant.design/docs/spec/introduce-cn)
- [Material Design 指南](https://material.io/design)
- [Apple Human Interface Guidelines](https://developer.apple.com/design/human-interface-guidelines/)

### 图表库文档
- [ECharts 官方文档](https://echarts.apache.org/zh/index.html)
- [TradingView Lightweight Charts](https://www.tradingview.com/lightweight-charts/)
- [D3.js 文档](https://d3js.org/)

### 色彩工具
- [Coolors 配色生成器](https://coolors.co/)
- [Adobe Color](https://color.adobe.com/)
- [WebAIM 对比度检查器](https://webaim.org/resources/contrastchecker/)

### 可访问性
- [WCAG 2.1 指南](https://www.w3.org/WAI/WCAG21/quickref/)
- [A11y Project](https://www.a11yproject.com/)

---

## 🔄 版本历史

### v1.0 (2026-01-27)
- 初始版本
- 定义核心设计原则
- 定义色彩系统（红涨绿跌）
- 定义K线图设计规范
- 定义板块资金流向热力图规范
- 定义仪表盘设计规范
- 定义交互设计规范
- 定义技术实现指南

---

## 📝 总结

本文档定义了MIA可视化系统的完整UI/UX设计要求，涵盖：

1. **设计原则**: 专业性、实时性、可读性、一致性
2. **色彩系统**: 红涨绿跌（中国A股标准）
3. **排版系统**: 字体、字号、行高、间距
4. **布局规范**: 页面布局、卡片布局、网格系统
5. **K线图规范**: 样式、交互、买卖点标注
6. **热力图规范**: 色彩映射、板块卡片、交互
7. **仪表盘规范**: 策略分析、个股分析、板块监控
8. **交互设计**: 加载状态、空状态、错误状态、反馈机制
9. **性能优化**: 渲染优化、动画性能
10. **响应式设计**: 断点策略、适配规则
11. **可访问性**: 色盲友好、键盘导航、屏幕阅读器
12. **技术实现**: ECharts配置、Streamlit集成

**核心要点**:
- ✅ 严格遵循红涨绿跌色彩方案（中国A股标准）
- ✅ 使用ECharts作为主力图表库
- ✅ 使用Streamlit作为UI框架
- ✅ 使用WebSocket实现实时数据更新
- ✅ 注重性能优化和可访问性

**下一步**:
1. 根据本文档实现可视化系统原型
2. 进行用户测试和反馈收集
3. 迭代优化设计细节
4. 完善技术实现

---

**文档维护**: MIA Team  
**最后更新**: 2026-01-27  
**白皮书依据**: 第五章 5.4 可视化系统
